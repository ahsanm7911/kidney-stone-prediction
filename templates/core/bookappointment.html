<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Online Appointment Booking System</title>
    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="assets/css/bookappointment.css" />
  </head>
  <body>
    <div class="sidebar" id="sidebar">
      <a href="#" id="menuToggle"><i class="fas fa-bars"></i></a>
      <div class="sidebar-content">
        <a href="dashboard.html"
          ><i class="fas fa-home"></i><span class="text"> Home Page</span></a
        >
        <a href="initiatescan.html"
          ><i class="fas fa-camera"></i><span class="text"> Scan Now</span></a
        >
        <a href="record.html"
          ><i class="fas fa-user"></i><span class="text"> Record</span></a
        >
      </div>
    </div>

    <!-- Header -->
    <header id="header">
      <h2 class="title">Kidney Stone Prediction System</h2>
      <button class="status" id="statusButton">Status</button>
      <a href="login.html"><button class="logout">Logout</button></a>
    </header>

    <!-- Form Section -->
    <!-- Updated Form Section -->
    <div class="form-section">
      <h2>Book Your Appointment Here!</h2>
      <form id="appointmentForm">
        <div class="row">
          <div class="col-md-6">
            <input
              type="text"
              class="form-control"
              placeholder="Patient Name"
              name="patientName"
              required
            />
          </div>
          <div class="col-md-6">
            <input
              type="number"
              class="form-control"
              placeholder="Patient Age"
              name="patientAge"
              required
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <select class="form-control" name="gender" required>
              <option value="" disabled selected>Select Gender</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
              <option value="Other">Other</option>
            </select>
          </div>
          <div class="col-md-6">
            <input
              type="email"
              class="form-control"
              placeholder="Email"
              name="email"
              required
            />
            <div class="invalid-feedback">
              Please enter a valid email address.
            </div>
          </div>
        </div>
        <div class="row">
          <!-- Doctor Name -->
          <div class="col-md-4">
            <select
              class="form-control"
              id="doctorName"
              name="doctorName"
              required
            >
              <option value="" disabled selected>Select Doctor</option>
              <option
                value="Dr. Adnan Anwar"
                data-city="Karachi"
                data-hospital="Aga Khan University Hospital"
              >
                Dr. Adnan Anwar
              </option>
              <option
                value="Dr. Sajjad Ahmed"
                data-city="Islamabad"
                data-hospital="Shifa International Hospital"
              >
                Dr. Sajjad Ahmed
              </option>
              <option
                value="Dr. Muhammad Farooq Afzal"
                data-city="Faisalabad"
                data-hospital="Faisal Hospital"
              >
                Dr. Muhammad Farooq Afzal
              </option>
              <option
                value="Dr. Arif Saeed"
                data-city="Rawalpindi"
                data-hospital="Quaid-e-Azam International Hospital"
              >
                Dr. Arif Saeed
              </option>
              <option
                value="Dr. Shahzad Anwar"
                data-city="Peshawar"
                data-hospital="Northwest General Hospital & Research Center"
              >
                Dr. Shahzad Anwar
              </option>
              <option
                value="Dr. Khalid Shafiq"
                data-city="Multan"
                data-hospital="Chaudhry Pervaiz Elahi Institute of Cardiology"
              >
                Dr. Khalid Shafiq
              </option>
              <option
                value="Dr. Muhammad Irfan Bashir"
                data-city="Quetta"
                data-hospital="Bolan Medical Complex Hospital"
              >
                Dr. Muhammad Irfan Bashir
              </option>
            </select>
          </div>
          <!-- City -->
          <div class="col-md-4">
            <input
              type="text"
              class="form-control"
              id="cityName"
              name="cityName"
              placeholder="City"
              readonly
              required
            />
          </div>
          <!-- Hospital -->
          <div class="col-md-4">
            <input
              type="text"
              class="form-control"
              id="hospitalName"
              name="hospitalName"
              placeholder="Hospital"
              readonly
              required
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-4">
            <input
              type="date"
              class="form-control"
              id="appointmentDate"
              name="appointmentDate"
              required
            />
          </div>
          <div class="col-md-4">
            <input
              type="time"
              class="form-control"
              id="startTime"
              name="startTime"
              required
            />
          </div>
          <div class="col-md-4">
            <input
              type="time"
              class="form-control"
              id="endTime"
              name="endTime"
              required
            />
          </div>
        </div>
        <div class="row">
          <div class="col-md-6">
            <select class="form-control" name="symptoms" required>
              <option value="" disabled selected>Select Symptoms</option>
              <option value="Blood in Urine">Blood in Urine</option>
              <option value="Frequent urination">Frequent urination</option>
              <option value="Passing small stones">
                Passing small stones or gravel in urine
              </option>
              <option value="Reduced urine flow">Reduced urine flow</option>
              <option value="Don't Know">Don't Know</option>
            </select>
          </div>
          <div class="col-md-6">
            <select class="form-control" name="diagnosisHistory" required>
              <option value="" disabled selected>Diagnosis History</option>
              <option value="No Previous Diagnosis">
                No Previous Diagnosis
              </option>
              <option value="Previously Diagnosed with Kidney Stones">
                Previously Diagnosed with Kidney Stones
              </option>
              <option value="Family History of Kidney Stones">
                Family History of Kidney Stones
              </option>
              <option value="History of Dehydration">
                History of Dehydration or Low Fluid Intake
              </option>
              <option value="No Relevant Medical History">
                No Relevant Medical History
              </option>
            </select>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6">
            <label for="uploadReports" class="form-label">Upload Reports</label>
            <input
              type="file"
              class="form-control"
              id="uploadReports"
              name="uploadReports[]"
              multiple
              required
            />
            <ul id="fileList" class="list-group mt-2"></ul>
          </div>
          <div class="col-md-6">
            <textarea
              class="form-control"
              name="description"
              placeholder="Description"
              rows="3"
            ></textarea>
          </div>
        </div>
        <button type="submit" class="btn mt-3">Book Appointment</button>
      </form>
      <p id="successMessage">Appointment has been booked!</p>
      <div id="errorMessages" class="mt-3"></div>
    </div>

    <!-- Status Modal -->
    <div
      class="modal fade"
      id="statusModal"
      tabindex="-1"
      aria-labelledby="statusModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="statusModalLabel">
              Appointment Details
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body" id="appointmentDetails"></div>
          <div class="modal-footer">
            <strong class="status-text">Status: Pending</strong>
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer Section -->
    <div class="footer">
      <div>
        <strong>Working hours:</strong>
        <p>Monday to Friday: 9:00 AM - 5:00 PM Saturday-Sunday: Closed</p>
      </div>
      <div>
        <strong>Phone No:</strong>
        <p>+92 330 5674469</p>
      </div>
      <div>
        <strong>Contact Us:</strong>
        <a
          href="mailto:usmanfarooq317@gmail.com,hamza0072x@gmail.com,umerahmed7865@gmail.com"
        >
          <p>contact@gmail.com</p></a
        >
      </div>
    </div>

    <script>
      document
        .getElementById("appointmentForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent the default form submission

          // Validate all fields
          let form = event.target;
          let isValid = form.checkValidity(); // Check form validity

          if (isValid) {
            // Show success message
            document.getElementById("successMessage").style.display = "block";

            // Reset the form after showing success message
            setTimeout(function () {
              form.reset(); // Reset the form fields
              document.getElementById("successMessage").style.display = "none"; // Hide the success message
            }, 3000); // Keep the success message visible for 3 seconds
          } else {
            // Show error message
            document.getElementById("errorMessages").innerText =
              "Please fill in all the required fields correctly.";
          }
        });

      // Function to expand or collapse sidebar
      const sidebar = document.getElementById("sidebar");
      const header = document.getElementById("header");
      const container = document.getElementById("main-container");
      const menuToggle = document.getElementById("menuToggle");

      menuToggle.addEventListener("click", function () {
        sidebar.classList.toggle("expanded");
        header.classList.toggle("expanded");
        container.style.paddingLeft = sidebar.classList.contains("expanded")
          ? "200px"
          : "60px";
      });

      const fileInput = document.getElementById("uploadReports");
      const fileList = document.getElementById("fileList");

      // Function to update the displayed file list
      function updateFileList() {
        fileList.innerHTML = ""; // Clear the list

        Array.from(fileInput.files).forEach((file, index) => {
          const listItem = document.createElement("li");
          listItem.className =
            "list-group-item d-flex justify-content-between align-items-center";
          listItem.innerHTML = `
        ${file.name}
        <button class="btn btn-danger btn-sm remove-file" data-index="${index}">Remove</button>
      `;
          fileList.appendChild(listItem);
        });
      }

      // Event listener for file input change
      fileInput.addEventListener("change", updateFileList);

      // Event listener for removing files
      fileList.addEventListener("click", function (event) {
        if (event.target.classList.contains("remove-file")) {
          const index = event.target.getAttribute("data-index");
          const filesArray = Array.from(fileInput.files);

          // Remove the selected file
          filesArray.splice(index, 1);

          // Update the file input with the remaining files
          const dataTransfer = new DataTransfer();
          filesArray.forEach((file) => dataTransfer.items.add(file));
          fileInput.files = dataTransfer.files;

          // Update the displayed file list
          updateFileList();
        }
      });

      document
        .getElementById("doctorName")
        .addEventListener("change", function () {
          const selectedOption = this.options[this.selectedIndex];
          document.getElementById("cityName").value =
            selectedOption.getAttribute("data-city") || "";
          document.getElementById("hospitalName").value =
            selectedOption.getAttribute("data-hospital") || "";
        });

      document
        .getElementById("appointmentForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent default form submission

          const form = event.target;

          if (form.checkValidity()) {
            alert("Appointment has been registered successfully"); // Show success message

            // Manually reset the file input field
            const fileInput = document.getElementById("uploadReports");
            fileInput.value = ""; // Clear the file input field
            document.getElementById("fileList").innerHTML = ""; // Clear the file list display

            form.reset(); // Reset other form fields
          } else {
            alert("Please fill all the required fields."); // Optional: additional error handling
          }
        });

      document
        .getElementById("statusButton")
        .addEventListener("click", function () {
          const form = document.getElementById("appointmentForm");
          const formData = new FormData(form);
          let details = "";

          // Loop through each form field
          for (const [key, value] of formData.entries()) {
            details += `<p><strong>${key}:</strong> ${value || "__________"}</p>`;
          }

          // Display details in the modal
          document.getElementById("appointmentDetails").innerHTML = details;

          // Show the modal
          const statusModal = new bootstrap.Modal(
            document.getElementById("statusModal")
          );
          statusModal.show();
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/script.js"></script>
  </body>
</html>
